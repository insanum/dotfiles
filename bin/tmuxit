#!/bin/bash

# Dell iDRAC6 -> 'console com2' / '#.'
# HP ILO -> 'vsp' / '<Esc>('
# SPARC ILOM -> 'start /SP/console' / '#.'
# Supermicro -> 'start /system1/sol1' / '<ESC>T'
# Cisco -> 'connect host' / <kill_network_connection>
# ipmiconsole -> '&.'

LTRX=10.13.114.20

if [ -z $1 ]; then
    CMD=`basename $0`
    echo "Usage: $CMD [-h] <t4|ldom|cisco|fat1|fat2|fat3|fat4|sunny|intel|amd|m3k|t5220t|t5220m|t5220b|sparky|foo>"
    exit
fi

if [ $1 = "-h" ]; then
   HORIZ=$1
   shift
fi

function tmuxopen()
{
    if [[ $1 -ne 0 ]]; then
        TGT="-t $1"
    fi
    tmux new-window $TGT -n $2 \; send-keys "$3" "Enter" \; split-window $HORIZ
}

if [[ $1 = t4 ]]; then
    tmux new-window -t 3 -n t4 "ssh root@10.13.114.21" \; split-window -v "ssh root@10.13.114.22" \; split-window -v "ssh root@10.13.114.23" \; select-layout -t 3 even-vertical
fi

if [[ $1 = ldom ]]; then
    tmux new-window -t 4 -n ldom "ssh root@10.13.114.33" \; split-window -v "ssh edavis@eadt4-ldom0" \; split-window -v "ssh edavis@eadt4-ldom0" \; select-layout -t 4 even-vertical
fi

if [[ $1 = cisco ]]; then
    tmux new-window -t 5 -n cisco "ssh admin@10.13.114.24" \; split-window -h "ssh admin@10.13.114.25"
fi

if [[ $1 = fat1 ]]; then
    #tmuxopen 6 fat1 "ipmiconsole -u ADMIN -P -h 10.13.114.26"
    tmuxopen 6 fat1 "ssh ADMIN@10.13.114.26"
fi

if [[ $1 = fat2 ]]; then
    #tmuxopen 7 fat2 "ipmiconsole -u ADMIN -P -h 10.13.114.27"
    tmuxopen 7 fat2 "ssh ADMIN@10.13.114.27"
fi

if [[ $1 = fat3 ]]; then
    #tmuxopen 8 fat3 "ipmiconsole -u ADMIN -P -h 10.13.114.28"
    tmuxopen 8 fat3 "ssh ADMIN@10.13.114.28"
fi

if [[ $1 = fat4 ]]; then
    #tmuxopen 9 fat4 "ipmiconsole -u ADMIN -P -h 10.13.114.29"
    tmuxopen 9 fat4 "ssh ADMIN@10.13.114.29"
fi

if [[ $1 = sunny ]]; then
    #tmuxopen 7 sunny "telnet $LTRX 10001"
    #tmuxopen 7 sunny "ipmiconsole -u root -P -h 10.13.114.30"
    tmuxopen 7 sunny "ssh root@10.13.114.30"
fi

if [[ $1 = intel ]]; then
    #tmuxopen 8 intel "telnet $LTRX 10003"
    #tmuxopen 8 intel "ipmiconsole -u root -P -h 10.13.114.32"
    tmuxopen 8 intel "ssh -o ServerAliveInterval=0 root@10.13.114.32"
fi

if [[ $1 = amd ]]; then
    #tmuxopen 9 amd "telnet $LTRX 10002"
    #tmuxopen 9 amd "ipmiconsole -u root -P -h 10.13.114.31"
    tmuxopen 9 amd "ssh -o ServerAliveInterval=0 root@10.13.114.31"
fi

if [[ $1 = m3k ]]; then
    tmuxopen 4 m3k "ssh edavis@10.13.106.60"
fi

if [[ $1 = t5220t ]]; then
    tmuxopen 5 t5220t "ssh root@10.13.106.69"
fi

if [[ $1 = t5220m ]]; then
    tmuxopen 6 t5220m "ssh root@10.13.106.68"
fi

if [[ $1 = t5220b ]]; then
    tmuxopen 0 t5220b "ssh root@10.13.106.67"
fi

if [[ $1 = sparky ]]; then
    tmuxopen 0 sparky "ssh root@10.13.106.66"
fi

if [[ $1 = foo ]]; then
    tmuxopen 0 foo "cu --speed 115200 -l /dev/ttyUSB0"
fi

